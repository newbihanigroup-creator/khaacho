# ============================================================================
# STARTUP VALIDATION - These variables are checked before server starts
# ============================================================================
# Required: DATABASE_URL (must be set or server won't start)
# Optional: REDIS_URL, TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, 
#           OPENAI_API_KEY, GOOGLE_APPLICATION_CREDENTIALS
# See: STARTUP_VALIDATION_QUICK_START.md for details
# ============================================================================

# Server Configuration
NODE_ENV=development
PORT=3000
API_VERSION=v1

# Database (Required - Validated at startup)
# Production: Use connection pooling with connection_limit parameter
# Formula: connection_limit = 10 per worker (adjust based on your setup)
# Example: 4 workers Ã— 10 connections = 40 total connections
# Ensure PostgreSQL max_connections > total connections
DATABASE_URL="postgresql://user:password@localhost:5432/khaacho?schema=public&connection_limit=10&pool_timeout=10&connect_timeout=5"

# Legacy pool settings (deprecated - use connection_limit in DATABASE_URL instead)
DB_POOL_MIN=10
DB_POOL_MAX=50
DB_CONNECTION_TIMEOUT=10000

# Slow query logging threshold (milliseconds)
SLOW_QUERY_THRESHOLD=500

# Redis (Optional - Validated at startup if provided)
# Use REDIS_URL on Render, or REDIS_HOST/PORT for local development
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWT (Required)
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_EXPIRES_IN=7d

# Twilio WhatsApp Integration (Optional - Validated at startup if provided)
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_twilio_auth_token_min_32_chars
TWILIO_WHATSAPP_NUMBER=+14155238886

# WhatsApp Business API (Alternative to Twilio)
WHATSAPP_API_URL=https://graph.facebook.com/v18.0
WHATSAPP_PHONE_NUMBER_ID=your-phone-number-id
WHATSAPP_ACCESS_TOKEN=your-access-token
WHATSAPP_VERIFY_TOKEN=your-verify-token
WHATSAPP_ASYNC=true

# OpenAI / LLM Configuration (Optional - Validated at startup if provided)
LLM_PROVIDER=openai
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OPENAI_MODEL=gpt-4o-mini

# Alternative LLM Providers
ANTHROPIC_API_KEY=sk-ant-...
ANTHROPIC_MODEL=claude-3-haiku-20240307
GEMINI_API_KEY=...
GEMINI_MODEL=gemini-pro

# Google Cloud (Optional - Validated at startup if provided)
# For Vision API (OCR) and Cloud Storage
GOOGLE_APPLICATION_CREDENTIALS=./path/to/service-account-key.json
GOOGLE_CLOUD_PROJECT_ID=your-project-id
GCS_BUCKET_NAME=khaacho-uploads
GCS_PROJECT_ID=your-project-id

# Alternative: Inline credentials (not recommended for production)
# GOOGLE_CLOUD_CREDENTIALS={"type":"service_account","project_id":"...","private_key":"..."}
# GCS_CREDENTIALS={"type":"service_account","project_id":"...","private_key":"..."}

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Logging
LOG_LEVEL=info
LOG_MAX_FILES=30d
LOG_MAX_SIZE=50m

# Performance
ENABLE_METRICS=true
METRICS_INTERVAL=60000

# Features
ENABLE_BACKGROUND_JOBS=true
ASYNC_NOTIFICATIONS=true

# App Configuration
APP_URL=http://localhost:3000
SUPPORT_PHONE=+977-9800000000

# Admin Credentials
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin123

# Product Matching Configuration
PRODUCT_MATCH_THRESHOLD=0.7

# Vendor Load Balancing Configuration
MAX_ACTIVE_ORDERS_PER_VENDOR=10
MAX_PENDING_ORDERS_PER_VENDOR=5
MONOPOLY_THRESHOLD=0.40
WORKING_HOURS_ENABLED=true
LOAD_BALANCING_STRATEGY=round-robin
ENABLE_LOAD_BALANCING=true
